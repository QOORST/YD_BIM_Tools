# 自動接合工具 - 快速入門指南

## 🚀 5 分鐘快速上手

### 步驟 1：開啟工具
在 Revit 中點擊「YD_BIM Tools」→「自動結構接合」

### 步驟 2：選擇模式
- **新手使用者**：使用「⚡ 快速模式」
- **進階使用者**：使用「🔧 進階模式」

### 步驟 3：設定規則（快速模式）
勾選要套用的接合規則：
- ✅ 牆 ↔ 樓板（樓板切割牆）
- ✅ 牆 ↔ 梁（梁切割牆）
- ✅ 樓板 ↔ 柱（柱切割樓板）

### 步驟 4：選擇處理範圍
- 🌐 **整個專案**：處理所有元素（大型專案慎用）
- 👁️ **目前視圖**：只處理目前視圖中的元素（推薦）
- 🎯 **目前選取**：只處理已選取的元素（測試用）

### 步驟 5：執行
1. **首次使用**：建議勾選「預覽模式」先測試
2. 點擊「✅ 開始執行」
3. 查看結果報告

---

## 💡 使用技巧

### 🎯 最佳實踐

#### 1. 首次使用
```
✅ 勾選「預覽模式」
✅ 選擇「目前視圖」
✅ 先處理小範圍測試
```

#### 2. 大型專案
```
✅ 分批處理（使用視圖過濾）
✅ 非工作時間執行
✅ 執行前先儲存專案
```

#### 3. 效能優化
```
✅ 減少「搜尋範圍膨脹」值
✅ 使用「目前視圖」限制範圍
✅ 關閉不必要的視圖
```

---

## 📊 優先級說明

### 切割優先級（數字越小優先級越高）

| 優先級 | 類別 | 說明 |
|--------|------|------|
| 🔴 **1** | 結構柱 | 最高優先級，會切割所有其他元素 |
| 🟠 **2** | 結構構架/梁 | 高優先級，會切割樓板和牆 |
| 🔵 **3** | 樓板 | 中優先級，會切割牆 |
| 🟢 **4** | 牆 | 低優先級，被大部分元素切割 |
| ⚫ **5** | 結構基礎 | 最低優先級 |

### 實際應用範例

#### 範例 1：柱與牆相交
```
結構柱（優先級 1）vs 牆（優先級 4）
→ 結果：柱切割牆 ✅
```

#### 範例 2：梁與樓板相交
```
結構梁（優先級 2）vs 樓板（優先級 3）
→ 結果：梁切割樓板 ✅
```

#### 範例 3：樓板與牆相交
```
樓板（優先級 3）vs 牆（優先級 4）
→ 結果：樓板切割牆 ✅
```

---

## 🔧 進階功能

### 自訂接合配對

如果內建規則不符合需求，可以建立自訂配對：

1. 切換到「🔧 進階模式」分頁
2. 在「自訂接合配對」區域：
   - 左側下拉選單：選擇「切割者」（A）
   - 右側下拉選單：選擇「被切割者」（B）
   - 點擊「➕ 加入」
3. 配對會顯示為「A → B」格式

#### 範例：讓基礎切割牆
```
1. 左側選擇「結構基礎」
2. 右側選擇「牆」
3. 點擊「加入」
4. 結果：結構基礎 → 牆
```

---

## ⚙️ 選項說明

### 執行選項

| 選項 | 說明 | 建議使用時機 |
|------|------|--------------|
| **預覽模式** | 不修改模型，僅顯示結果 | 首次使用、測試設定 |
| **只調整切割順序** | 不建立新接合，只調整已接合元素的順序 | 元素已接合但順序錯誤 |

### 進階選項

| 選項 | 預設值 | 說明 |
|------|--------|------|
| **搜尋範圍膨脹** | 1.0 ft | 增加此值可找到更多相鄰元素，但會增加處理時間 |
| **輸出 CSV** | 關閉 | 輸出詳細記錄，用於追蹤和除錯 |

---

## 📈 結果解讀

執行完成後會顯示統計報告：

```
檢查配對：150
新接合：45
切換順序：12
原已接合：88
失敗/略過：5
```

### 各項目說明

- **檢查配對**：總共檢查了多少對元素
- **新接合**：成功建立的新接合數量
- **切換順序**：調整切割順序的數量
- **原已接合**：已經正確接合的數量
- **失敗/略過**：無法處理的數量

### 失敗原因分析

如果「失敗/略過」數量較多，可能原因：
1. 元素幾何形狀複雜
2. 元素已達到接合數量上限
3. 元素類型不支援接合
4. 元素被鎖定或在群組中

---

## ⚠️ 注意事項

### 執行前
- ✅ 儲存專案
- ✅ 關閉不必要的視圖
- ✅ 確認沒有其他使用者正在編輯

### 執行中
- ⏳ 大型專案可能需要數分鐘
- 🚫 不要關閉 Revit
- 🚫 不要切換到其他專案

### 執行後
- 📊 檢查結果報告
- 👁️ 視覺檢查接合結果
- 💾 儲存專案

---

## 🆘 常見問題

### Q1：為什麼有些元素沒有被接合？
**A**：可能原因：
- 元素不在處理範圍內
- 元素類型不支援接合
- 元素沒有相交
- 搜尋範圍膨脹值太小

### Q2：處理速度很慢怎麼辦？
**A**：優化建議：
- 使用「目前視圖」限制範圍
- 減少「搜尋範圍膨脹」值
- 分批處理大型專案

### Q3：如何復原操作？
**A**：
- 使用 Revit 的「復原」功能（Ctrl+Z）
- 或關閉專案不儲存，重新開啟

### Q4：預覽模式顯示什麼？
**A**：
- 顯示將要處理的元素數量
- 不會實際修改模型
- 用於確認設定是否正確

---

## 📞 技術支援

如有問題或建議，請聯繫：
- 📧 Email: support@yd-bim.com
- 🌐 Website: www.yd-bim.com
- 📱 Phone: +886-XXX-XXXX

---

**版本**：v2.2.6  
**更新日期**：2024-12-24  
**文件版本**：1.0

