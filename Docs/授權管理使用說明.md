# YD_BIM Tools 授權管理使用說明

## 概述

YD_BIM Tools 現在包含完整的授權管理系統，支援：
- ✅ 授權碼輸入和啟用
- ✅ 機器碼綁定
- ✅ 多種授權類型（試用版、標準版、專業版）
- ✅ 授權狀態查看
- ✅ 功能權限管理

## 授權類型

### 試用版 (Trial)
- **有效期限**：30 天
- **功能範圍**：基本功能
- **適用場景**：評估和測試使用

### 標準版 (Standard)
- **有效期限**：365 天
- **功能範圍**：所有基本功能 + 標準功能
- **適用場景**：一般專案使用

### 專業版 (Professional)
- **有效期限**：365 天
- **功能範圍**：所有功能（包含進階功能）
- **適用場景**：大型專案和企業使用

## 使用流程

### 1. 查看機器碼

1. 啟動 Revit
2. 點擊「YD_BIM Tools」選項卡
3. 點擊「About」面板中的「授權管理」按鈕
4. 在「授權狀態」頁籤中查看機器碼
5. 點擊「複製」按鈕複製機器碼

### 2. 取得授權金鑰

將機器碼提供給技術支援，取得對應的授權金鑰。

### 3. 啟用授權

1. 在授權管理視窗中切換到「啟用授權」頁籤
2. 將授權金鑰貼到輸入框中
3. 點擊「啟用授權」按鈕
4. 系統會自動驗證並啟用授權

### 4. 查看授權狀態

在「授權狀態」頁籤中可以查看：
- 授權狀態（已啟用/未啟用/已過期）
- 授權類型
- 使用者名稱
- 公司名稱
- 啟用日期
- 到期日期
- 剩餘天數
- 機器碼
- 可用功能列表

## 授權金鑰格式

授權金鑰是一個 Base64 編碼的 JSON 字串，包含以下資訊：
```json
{
  "IsEnabled": true,
  "LicenseType": "Professional",
  "UserName": "Owen",
  "Company": "YD",
  "StartDate": "2025-12-30T17:36:46",
  "ExpiryDate": "2026-12-30T17:36:46",
  "LicenseKey": "",
  "MachineCode": ""
}
```

## 生成測試授權金鑰

### 使用 PowerShell 命令

```powershell
# 生成專業版授權（365天）
$license = @{
    IsEnabled=$true
    LicenseType="Professional"
    UserName="Owen"
    Company="YD"
    StartDate=(Get-Date).ToString("yyyy-MM-ddTHH:mm:ss")
    ExpiryDate=(Get-Date).AddDays(365).ToString("yyyy-MM-ddTHH:mm:ss")
    LicenseKey=""
    MachineCode=""
}
$json = $license | ConvertTo-Json -Compress
$bytes = [System.Text.Encoding]::UTF8.GetBytes($json)
$key = [Convert]::ToBase64String($bytes)
Write-Host "License Key:"
Write-Host $key
$key | Set-Clipboard
```

### 生成不同類型的授權

```powershell
# 試用版（30天）
$license.LicenseType = "Trial"
$license.ExpiryDate = (Get-Date).AddDays(30).ToString("yyyy-MM-ddTHH:mm:ss")

# 標準版（365天）
$license.LicenseType = "Standard"
$license.ExpiryDate = (Get-Date).AddDays(365).ToString("yyyy-MM-ddTHH:mm:ss")

# 專業版（365天）
$license.LicenseType = "Professional"
$license.ExpiryDate = (Get-Date).AddDays(365).ToString("yyyy-MM-ddTHH:mm:ss")
```

### 綁定機器碼

如果要綁定特定機器，設定 `MachineCode` 欄位：
```powershell
$license.MachineCode = "A1B2-C3D4-E5F6-G7H8"
```

## 功能權限

不同授權類型的功能權限：

### 試用版
- ✅ COBie 範本匯出

### 標準版
- ✅ COBie 範本匯出
- ✅ COBie 欄位管理
- ✅ COBie 匯出
- ✅ COBie 匯入

### 專業版
- ✅ 所有功能（包含上述所有功能）
- ✅ 裝修工具
- ✅ 自動接合工具
- ✅ 族參數滑桿
- ✅ 專案參數滑桿
- ✅ 管線套管
- ✅ 管線轉 ISO
- ✅ 管線自動避讓

## 技術支援

如有任何問題，請聯繫：
- **Email**: qoorst123456@gmail.com
- **電話**: 04-2376-1698
- **網站**: http://www.yesdir.com.tw

