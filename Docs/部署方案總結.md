# YD_BIM Tools 部署方案總結

## 問題

在其他電腦上無法使用安裝程式載入程式，目前只能手動複製檔案。

## 解決方案

我們提供了三種部署方式，從最簡單到最手動：

### 方案一：自動部署腳本（推薦）✨

**優點**：
- 全自動化，減少人為錯誤
- 自動偵測已安裝的 Revit 版本
- 自動創建 .addin 配置檔案
- 可重複使用於多台電腦

**步驟**：

1. **在開發電腦上準備部署包**：
   ```powershell
   cd "專案目錄\Tools"
   .\PrepareDeployment.ps1
   ```
   
   這會在 `Output\Deployment` 創建完整的部署包。

2. **複製到目標電腦**：
   - 將整個 `Deployment` 資料夾複製到 USB 隨身碟
   - 或複製到網路共享資料夾

3. **在目標電腦上部署**：
   - 以系統管理員身分執行 PowerShell
   - 切換到 Deployment 資料夾
   - 執行 `.\Deploy.ps1`
   - 按照提示選擇要部署的 Revit 版本

4. **重新啟動 Revit**

### 方案二：使用 Inno Setup 安裝程式

**優點**：
- 專業的安裝體驗
- 自動處理所有配置
- 支援解除安裝

**步驟**：

1. 準備安裝檔案：
   ```powershell
   cd Installer
   .\Prepare_Files_Simple.ps1
   ```

2. 使用 Inno Setup Compiler 編譯 `YD_BIM_Setup.iss`

3. 將生成的 `.exe` 安裝程式複製到目標電腦執行

**限制**：
- 需要在開發電腦上安裝 Inno Setup
- 如果目標電腦有安全限制可能無法執行

### 方案三：完全手動複製

**優點**：
- 不需要執行任何腳本
- 適用於有嚴格安全限制的環境

**步驟**：

詳見 `Docs\手動部署指南.md`

簡要步驟：
1. 創建目標資料夾：`C:\ProgramData\Autodesk\Revit\Addins\2024\YD_BIM\`
2. 複製所有 DLL 檔案
3. 複製 Resources\Icons 資料夾
4. 創建 .addin 配置檔案

## 檔案結構

### 部署包結構

```
Deployment\
├── 2024\
│   ├── YD_RevitTools.LicenseManager.dll
│   ├── Newtonsoft.Json.dll
│   ├── System.Text.Json.dll
│   ├── (其他 15 個依賴 DLL)
│   └── Resources\
│       └── Icons\
│           └── (圖示檔案)
├── 2025\
│   └── (同 2024 結構)
├── Deploy.ps1
├── README.txt
└── PROJECT_README.txt
```

### 目標電腦上的安裝位置

```
C:\ProgramData\Autodesk\Revit\Addins\
├── 2024\
│   ├── YD_BIM\
│   │   ├── YD_RevitTools.LicenseManager.dll
│   │   ├── (所有依賴 DLL)
│   │   └── Resources\Icons\
│   └── YD_RevitTools.LicenseManager.addin
└── 2025\
    ├── YD_BIM\
    └── YD_RevitTools.LicenseManager.addin
```

## 相關檔案

### 腳本檔案

- `Tools\PrepareDeployment.ps1` - 準備部署包
- `Tools\Deploy.ps1` - 在目標電腦上執行部署
- `Tools\GenerateLicenseKey.ps1` - 生成測試授權金鑰

### 文檔檔案

- `Docs\手動部署指南.md` - 詳細的手動部署說明
- `Docs\授權管理使用說明.md` - 授權系統使用說明
- `快速部署說明.txt` - 快速參考指南
- `Tools\DEPLOYMENT_README.txt` - 部署包內的說明文件

## 常見問題

### Q: 為什麼圖示顯示為 0 files？

A: 這是因為 `Resources\Icons` 資料夾可能是空的或圖示檔案不在正確位置。這不影響功能，只是圖示可能不會顯示。

### Q: 如何在多台電腦部署？

A: 使用方案一：
1. 執行一次 `PrepareDeployment.ps1`
2. 將 Deployment 資料夾複製到網路共享位置
3. 在每台電腦上執行 `Deploy.ps1`

### Q: PowerShell 腳本無法執行？

A: 執行以下命令允許腳本執行：
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### Q: 需要系統管理員權限嗎？

A: 是的，因為需要寫入 `C:\ProgramData` 目錄。

## 測試清單

部署後請檢查：

- [ ] Revit 啟動時沒有錯誤訊息
- [ ] 「YD_BIM Tools」選項卡出現在 Ribbon 介面
- [ ] 點擊「授權管理」按鈕可以開啟授權視窗
- [ ] 可以查看機器碼
- [ ] 可以輸入授權金鑰
- [ ] 圖示正常顯示（如果有圖示檔案）

## 建議

### 對於開發團隊

1. **定期測試部署流程**：在乾淨的虛擬機上測試部署
2. **維護圖示資源**：確保 `Resources\Icons` 有所有必要的圖示
3. **版本控制**：在部署包中包含版本資訊
4. **自動化**：考慮使用 CI/CD 自動生成部署包

### 對於使用者

1. **優先使用自動部署腳本**：減少錯誤
2. **保留部署包**：可重複使用
3. **記錄問題**：如果遇到問題，記錄錯誤訊息
4. **聯繫支援**：遇到問題及時聯繫技術支援

## 技術支援

- **Email**: qoorst123456@gmail.com
- **電話**: 04-2376-1698
- **網站**: www.ydbim.com

## 更新歷史

- **2024-12-30**: 創建自動部署腳本系統
- **2024-12-30**: 新增授權管理功能
- **2024-12-25**: v2.2.9 版本發布

