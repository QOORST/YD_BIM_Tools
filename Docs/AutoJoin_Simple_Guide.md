# 自動結構接合 - 簡化版使用說明

## 功能概述

簡化版自動接合功能提供了一個直觀的介面，讓您可以快速地根據結構元件的優先順序自動建立接合關係。

### 優先順序規則

系統遵循以下優先順序規則：

**柱 > 梁 > 版 > 牆**

這意味著：
- 柱會切割所有碰觸的梁、版、牆
- 梁會切割所有碰觸的版、牆
- 版會切割所有碰觸的牆
- 牆被所有碰觸的結構元件切割

## 使用方式

### 1. 啟動功能

在 Revit 中執行「自動結構接合（簡化版）」命令。

### 2. 選擇接合模式

在介面中選擇要處理的物件類型：

- **柱**：處理所有柱，並將它們與碰觸的梁、版、牆接合
- **梁**：處理所有梁，並將它們與碰觸的版、牆接合
- **版**：處理所有版，並將它們與碰觸的牆接合
- **牆**：處理所有牆，並將它們與碰觸的柱、梁、版接合

### 3. 選擇處理範圍

- **整個專案**：處理專案中所有符合條件的元件
- **目前視圖**：只處理目前視圖中可見的元件
- **目前選取**：只處理目前選取的元件

### 4. 執行選項

- **修正錯誤的接合順序**：如果元件已經接合但順序錯誤，系統會自動修正
- **預覽模式（不修改模型）**：先預覽結果，不實際修改模型

### 5. 執行

點擊「開始執行」按鈕，系統會自動處理所有符合條件的元件。

## 範例場景

### 場景 1：處理所有柱

1. 選擇「柱」模式
2. 選擇「整個專案」範圍
3. 勾選「修正錯誤的接合順序」
4. 點擊「開始執行」

結果：所有柱會與碰觸的梁、版、牆建立接合，並確保柱切割這些元件。

### 場景 2：處理選取的梁

1. 在 Revit 中選取要處理的梁
2. 選擇「梁」模式
3. 選擇「目前選取」範圍
4. 點擊「開始執行」

結果：選取的梁會與碰觸的版、牆建立接合，並確保梁切割這些元件。

### 場景 3：預覽模式

1. 選擇任意模式和範圍
2. 勾選「預覽模式（不修改模型）」
3. 點擊「開始執行」

結果：系統會顯示將要執行的操作，但不會實際修改模型。

## 技術細節

### 碰撞檢測

系統使用 Revit API 的幾何碰撞檢測功能，確保只有真正相交的元件才會被接合。

### 接合順序

系統會自動根據優先順序規則設定正確的切割順序：
- 優先順序高的元件會切割優先順序低的元件
- 如果已經接合但順序錯誤，系統會自動修正（需勾選「修正錯誤的接合順序」）

### 錯誤處理

如果某些元件無法接合（例如幾何問題），系統會跳過這些元件並繼續處理其他元件。

## 注意事項

1. **備份模型**：建議在執行前先備份模型
2. **預覽模式**：建議先使用預覽模式確認結果
3. **效能**：處理大型專案時可能需要較長時間
4. **授權**：此功能需要試用版、標準版或專業版授權

## 常見問題

### Q: 為什麼有些元件沒有被接合？

A: 可能的原因：
- 元件沒有實際相交
- 元件的幾何無法取得
- 元件類型不支援接合

### Q: 如何確認接合順序是否正確？

A: 可以使用 Revit 的「顯示接合順序」功能檢查。

### Q: 可以一次處理多種類型的元件嗎？

A: 目前每次只能處理一種類型的元件。如果需要處理多種類型，請分別執行多次。

## 版本歷史

- v1.0 (2024-12-24)
  - 初始版本
  - 支援柱、梁、版、牆的自動接合
  - 支援優先順序規則
  - 支援預覽模式

